import Head from 'next/head'
import { Inter } from 'next/font/google'
import { GET_CONTACT_LIST } from '@/query'
import { useQuery } from '@apollo/client'
import { type ContactList } from '@/query/type'

const inter = Inter({ subsets: ['latin'] })

export default function Home() {
  const favoriteContactConditions = {
    id: { _in: [4687, 4688] },
    first_name: { _like: '%%' }
  }

  const regularContactConditions = {
    id: { _nin: [4687, 4688] },
    first_name: { _like: '%%' }
  }

  const { loading, error, data } = useQuery<ContactList>(GET_CONTACT_LIST, {
    variables: {
      limit: 10,
      offset: 0,
      order_by: { created_at: 'asc' },
      where_favorit: favoriteContactConditions,
      where_regular: regularContactConditions
    }
  })
  if (loading) return <p>Loading...</p>
  if (error != null) return <p>Error: {error.message}</p>
  const { favorit, regular } = data ?? { favorit: [], regular: [] }
  return (
    <>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className={`${inter.className}`}>
        <div>favorit:</div>
        {favorit.map(({ id, first_name, last_name, phones }) => (
          <div key={id}>
            {first_name} {last_name}
            {phones.map(({ number }) => (
              <div key={number}>{number}</div>
            ))}
          </div>
        ))}
        <div>regular:</div>
        {regular.map(({ id, first_name }) => (
          <div key={id}>
            {id}
            {first_name}
          </div>
        ))}
      </main>
    </>
  )
}
